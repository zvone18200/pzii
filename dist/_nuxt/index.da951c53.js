import{i as $,o as a,j as l,l as e,u as f,t as m,k as g,N as h,G as p,Y as x,X as k,y as C,F as y,m as j,c as L}from"./entry.5d8d0cd0.js";import{u as N}from"./useSupabaseClient.787af177.js";import{u as B}from"./fetch.91d3daae.js";const D={class:"shadow rounded overflow-hidden flex justify-between mb-4"},F={class:"flex"},S=["src"],V={class:"p-3"},O={class:"text-2xl"},z={class:"text-blue-400"},A={class:"p-3 flex"},E={__name:"ListingCard",props:{listing:Object},emits:["deleteClick"],setup(t,{emit:s}){const i=$();return(c,n)=>{const o=x;return a(),l("div",D,[e("div",F,[e("img",{src:`${f(i).public.supabase.url}/storage/v1/object/public/images/${t.listing.image}`,alt:"",class:"w-80 mr-3 h-44"},null,8,S),e("div",V,[e("h1",O,m(t.listing),1),e("p",z,"$"+m(t.listing.price),1)])]),e("div",A,[g(o,{class:"text-blue-400 mr-4",to:`/profile/listings/view/${t.listing.id}`},{default:h(()=>[p("Prika\u017Ei")]),_:1},8,["to"]),e("p",{class:"text-red-400 cursor-pointer",onClick:n[0]||(n[0]=r=>s("deleteClick",t.listing.id,t.listing.image))}," Izbrisi ")])])}}},G={class:"flex justify-between mt-24 items-center"},I=e("h1",{class:"text-6xl"},"Moja Lista",-1),M={class:"shadow rounded p-3 mt-5"},U={__name:"index",async setup(t){let s,i;const c=k(),n=N(),{data:o,refresh:r}=([s,i]=C(()=>B(`/api/car/listings/user/${c.value.id}`,"$FmO4eLaDnh")),s=await s,i(),s),b=async(d,u)=>{await $fetch(`/api/car/listings/${d}`,{method:"delete"}),await n.storage.from("images").remove(u),r()};return(d,u)=>{const w=x,v=E;return a(),l("div",null,[e("div",G,[I,g(w,{to:"/profile/listings/create",class:"w-9 h-9 bg-blue-400 flex justify-center items-center rounded-full text-white font-bold cursor-pointer"},{default:h(()=>[p("+")]),_:1})]),e("div",M,[(a(!0),l(y,null,j(f(o),_=>(a(),L(v,{key:_.id,listing:_,onDeleteClick:b},null,8,["listing"]))),128))])])}}};export{U as default};
