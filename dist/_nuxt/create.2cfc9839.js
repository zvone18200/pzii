import{r as x,o as i,j as c,l as a,t as h,w as y,V as U,u as d,F as I,m as C,L as b,v as $,W as S,f as k,s as M,X as j,b as B,k as v,E as N}from"./entry.5d8d0cd0.js";import{u as F}from"./useCars.45e6d2fc.js";import{u as T}from"./useSupabaseClient.787af177.js";const D={class:"flex flex-col w-[48%] mt-2"},L={for:"",class:"text-cyan-500 mb-1 text-sm"},O=["value"],R={__name:"Select",props:{title:String,name:String,options:Array},emits:["changeInput"],setup(n,{emit:u}){const l=n,t=x(""),e=()=>{u("changeInput",t.value,l.name)};return(r,s)=>(i(),c("div",D,[a("label",L,h(n.title),1),y(a("select",{name:"",id:"",class:"p-2 border w-100 rounded",onChange:e,"onUpdate:modelValue":s[0]||(s[0]=o=>b(t)?t.value=o:null)},[(i(!0),c(I,null,C(n.options,o=>(i(),c("option",{key:o.id,value:o},h(o),9,O))),128))],544),[[U,d(t)]])]))}},E={class:"flex flex-col w-[48%] mt-2"},G={for:"",class:"text-cyan-500 mb-1 text-sm"},K=["placeholder","name"],W={__name:"Input",props:{title:String,name:String,placeholder:String},emits:["changeInput"],setup(n,{emit:u}){const l=n,t=x(""),e=()=>{u("changeInput",t.value,l.name)};return(r,s)=>(i(),c("div",E,[a("label",G,h(n.title),1),y(a("input",{type:"text",class:"p-2 border w-100 rounded",placeholder:n.placeholder,"onUpdate:modelValue":s[0]||(s[0]=o=>b(t)?t.value=o:null),name:n.name,onInput:e},null,40,K),[[$,d(t)]])]))}},X={class:"flex flex-col w-[100%] mt-2"},q={for:"",class:"text-cyan-500 mb-1 text-sm"},z=["placeholder","name"],H={__name:"Textarea",props:{title:String,name:String,placeholder:String},emits:["changeInput"],setup(n,{emit:u}){const l=n,t=x(""),e=()=>{u("changeInput",t.value,l.name)};return(r,s)=>(i(),c("div",X,[a("label",q,h(n.title),1),y(a("textarea",{type:"text",class:"p-2 border w-100 rounded",placeholder:n.placeholder,"onUpdate:modelValue":s[0]||(s[0]=o=>b(t)?t.value=o:null),name:n.name,onInput:e},null,40,z),[[$,d(t)]])]))}},J={class:"col-md-5 offset-md-1 mt-2 w-[100%]"},P=a("label",{for:"",class:"text-cyan-500 mb-1 text-sm"},"Image*",-1),Q={class:"mt-2"},Y={class:"form-group"},Z={class:"relative"},ee=a("span",{class:"cursor-pointer"},"Browser File",-1),te={key:0,class:"border p-2 mt-3 w-56"},ae=["src"],se={__name:"Image",emits:["changeInput"],setup(n,{emit:u}){const l=S("carImage",()=>({preview:null,image:null}));k(()=>{l.value={preview:null,image:null}});const t=e=>{const r=e.target;if(r.files){const s=new FileReader;s.onload=o=>{l.value.preview=o.target.result},l.value.image=r.files[0],s.readAsDataURL(r.files[0]),u("changeInput",r.files[0],"image")}};return(e,r)=>(i(),c("div",J,[P,a("form",Q,[a("div",Y,[a("div",Z,[a("input",{type:"file",accept:"image/*",class:"opacity-0 absolute cursor-pointer",onChange:t},null,32),ee]),d(l).preview?(i(),c("div",te,[a("img",{src:d(l).preview,class:"img-fluid"},null,8,ae)])):M("",!0)])])]))}},ne=a("div",{class:"mt-24"},[a("h1",{class:"text-6xl"},"Napravi novu listu")],-1),le={class:"shadow rounded p-3 mt-5 flex flex-wrap justify-between"},oe={key:0,class:"mt-3 text-red-400"},ue={__name:"create",setup(n){const{makes:u}=F(),l=T(),t=j(),e=S("adInfo",()=>({make:"",model:"",year:"",miles:"",price:"",city:"",seats:"",features:"",description:"",image:null})),r=x("");k(()=>{e.value={make:"",model:"",year:"",miles:"",price:"",city:"",seats:"",features:"",description:"",image:null}});const s=(m,p)=>{e.value[p]=m},o=[{id:1,title:"Model *",name:"model",placeholder:"Civic"},{id:2,title:"Godina *",name:"year",placeholder:"2019"},{id:3,title:"Kilometri *",name:"miles",placeholder:"10000"},{id:4,title:"Cijena *",name:"price",placeholder:"85000"},{id:5,title:"Grad *",name:"city",placeholder:""},{id:6,title:"Broj sjedala *",name:"seats",placeholder:"5"},{id:7,title:"Oprema *",name:"features",placeholder:""}];B(()=>{for(let m in e.value)if(!e.value[m])return!0;return!1});const V=async()=>{const m=Math.floor(Math.random()*1e16),{data:p,error:w}=await l.storage.from("images").upload("public/"+m,e.value.image),_={...e.value,features:e.value.features.split(", "),numberOfSeats:e.value.seats,name:`${e.value.make} ${e.value.model}`,listerId:t.value.id,image:p.path};delete _.seats;try{const g=await $fetch("/api/car/listings",{method:"post",body:_});N("/profile/listings")}catch(g){r.value=g.statusMessage,await l.storage.from("images").remove(p.path)}};return(m,p)=>{const w=R,_=W,g=H,A=se;return i(),c("div",null,[ne,a("div",le,[v(w,{title:"Marka*",options:d(u),name:"make",onChangeInput:s},null,8,["options"]),(i(),c(I,null,C(o,f=>v(_,{key:f.id,title:f.title,name:f.name,placeholder:f.placeholder,onChangeInput:s},null,8,["title","name","placeholder"])),64)),v(g,{title:"Opis *",name:"description",placeholder:"",onChangeInput:s}),v(A,{onChangeInput:s}),a("div",null,[a("button",{disabled:!1,onClick:V,class:"bg-blue-400 text-white rounded py-2 px-7 mt-3"}," Spremi "),d(r)?(i(),c("p",oe,h(d(r)),1)):M("",!0)])])])}}};export{ue as default};
